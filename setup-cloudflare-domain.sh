#!/bin/bash

echo "üåê RogueSim Domain Setup for roguesim.com"
echo "=========================================="

echo "‚úÖ Your app is confirmed working on: http://49.13.197.91:8080"
echo ""

echo "üî• CLOUDFLARE SETUP INSTRUCTIONS:"
echo "=================================="
echo ""
echo "1. üì± Go to Cloudflare Dashboard ‚Üí roguesim.com ‚Üí DNS Records"
echo ""
echo "2. ‚ûï Add these DNS records:"
echo "   Type: A"
echo "   Name: @"
echo "   IPv4: 49.13.197.91"
echo "   Proxy: üü† Proxied (Orange Cloud ON)"
echo ""
echo "   Type: A" 
echo "   Name: www"
echo "   IPv4: 49.13.197.91"
echo "   Proxy: üü† Proxied (Orange Cloud ON)"
echo ""

echo "3. ‚öôÔ∏è Configure Cloudflare for Port 8080:"
echo ""
echo "   Go to: SSL/TLS ‚Üí Origin Server"
echo "   Set Origin Server: 49.13.197.91:8080"
echo ""
echo "   Go to: Network ‚Üí Network Settings"
echo "   Enable: HTTP2 to Origin"
echo ""

echo "4. üîß Page Rules (if needed):"
echo "   URL: roguesim.com/*"
echo "   Setting: Resolve Override ‚Üí 49.13.197.91:8080"
echo ""

echo "5. üß™ Test your domain:"
echo "   ‚Ä¢ http://roguesim.com"
echo "   ‚Ä¢ https://roguesim.com"
echo ""

echo "‚ö†Ô∏è  IMPORTANT: Cloudflare only proxies certain ports!"
echo "   Port 8080 should work, but if not, see Option 2 below."
echo ""

echo "üöÄ OPTION 2: Switch to Standard Port 80"
echo "======================================="
echo ""
echo "If port 8080 doesn't work with Cloudflare, run this:"
echo ""
echo "# Stop whatever is using port 80"
echo "systemctl stop apache2 nginx lighttpd || true"
echo "docker stop \$(docker ps -q) || true"
echo ""
echo "# Update to use port 80"
echo "sed -i 's/\"8080:5000\"/\"80:5000\"/g' docker-compose.yml"
echo "docker-compose up -d"
echo ""
echo "Then your domain will work perfectly with standard HTTP/HTTPS."
echo ""

echo "üåê Expected Results:"
echo "==================="
echo "After setup, these should all work:"
echo "‚Ä¢ http://roguesim.com ‚Üí Your RogueSim app"
echo "‚Ä¢ https://roguesim.com ‚Üí Your RogueSim app (with SSL)"
echo "‚Ä¢ www.roguesim.com ‚Üí Your RogueSim app"
echo ""

echo "üîç Troubleshooting:"
echo "==================="
echo "If domain doesn't work:"
echo "1. Wait 5-10 minutes for DNS propagation"
echo "2. Check Cloudflare DNS ‚Üí Should show 'Proxied'"
echo "3. Try switching to port 80 (Option 2 above)"
echo "4. Use dig roguesim.com to verify DNS"
echo ""

echo "‚úÖ Your server is ready! Just configure Cloudflare DNS now." 